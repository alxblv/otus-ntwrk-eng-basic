# Лабораторная работа №3. Расчет подсетей IPv4

- [Задача 1](#задача-1)
  - [Решение:](#решение)
    - [1. Количество бит подсети](#1-количество-бит-подсети)
    - [2. Количество созданных подсетей](#2-количество-созданных-подсетей)
    - [3. Количество бит узлов в подсети](#3-количество-бит-узлов-в-подсети)
    - [4. Количество узлов в подсети](#4-количество-узлов-в-подсети)
    - [5. Сетевой адрес этой подсети](#5-сетевой-адрес-этой-подсети)
    - [6. IPv4-адрес первого узла в этой подсети](#6-ipv4-адрес-первого-узла-в-этой-подсети)
    - [7. IPv4-адрес последнего узла в этой подсети](#7-ipv4-адрес-последнего-узла-в-этой-подсети)
    - [8. Широковещательный IPv4-адрес в этой подсети](#8-широковещательный-ipv4-адрес-в-этой-подсети)
- [Задача 2](#задача-2)
- [Задача 3](#задача-3)
- [Задача 4](#задача-4)
- [Задача 5](#задача-5)
- [Задача 6](#задача-6)

## Задача 1:

|                     Дано: |                      |
| :------------------------ | :------------------  |
| IP-адрес узла             | $192.168.200.139$    |
| Исходная маска подсети    | $255.255.255.0$      |
| Новая маска подсети       | $255.255.255.224$    |

|                       Найти:   |                     |
| :----------------------------- | :------------------ |
| Количество бит подсети         |                     |
| Количество созданных подсетей  |                     |
| Количество бит узлов в подсети |                     |
| Количество узлов в подсети     |                     |
| Сетевой адрес этой подсети     |                     |
| IPv4-адрес первого узла в этой подсети |             |
| IPv4-адрес последнего узла в этой подсети |          |
| Широковещательный IPv4-адрес в этой подсети |        |


### Решение:

#### 1. Количество бит подсети

Получить исходную длину префикса несложно, маска очень удачная - покрывает все первые три октета целиком.

Исходная длина префикса: /24

Сколько бит добавляется в новую маску?

Переводим 224 в двоичную систему счисления.

В октете всего 8 разрядов, верхний - это $2 ^ 7 = 128$.

В 224, очевидно, входит 128, ибо сумма всех более младших разрядов не превышает 128, и никак не может быть равным 224 $(64 + 32 + 16 + 8 + 4 + 2 + 1 = 127)$.

$224 - 128 = 96$

Входит ли следующий разряд - теперь это $2 ^ 6 = 64$?

Очевидно, да, ибо сумма всех более младших разрядов не превышает 64, и никак не может быть равным 96 $(32 + 16 + 8 + 4 + 2 + 1 = 63)$.

$96 - 64 = 32$

Входит ли следующий разряд - теперь это $2 ^ 5 = 32$?

Очевидно, да:

$32 - 32 = 0$

Остался ноль, следовательно, во всех остальных разрядах нули.

Получили:

$224 = 1 * 2 ^ 7 + 1 * 2 ^ 6 + 1 * 2 ^ 5 + 0 * 2 ^ 4 + 0 * 2 ^ 3 + 0 * 2 ^ 2 + 0 * 2 ^ 1 + 0 * 2 ^ 0$

В двоичном виде: $11100000_2$

Т.е. новая маска в двоичном виде: 11111111.11111111.11111111.11100000

Всего ей покрывает 27 бит.

Новая длина префикса (оно же искомое количество бит новой подсети): /27

#### 2. Количество созданных подсетей

Теперь хотим найти количество созданных подсетей.

Сетевая часть адреса увеличилась на 3 бита (исходная длина была равна 24 битам, теперь стала 27).

Соответственно, количество различных новых подсетей - это количество различных чисел, которые занимают 3 бита. Дальше следует попытка объяснить происхождение формулы $A ^ N$ (A - число "состояний" (в нашем случае, значений, которые может принимать бит, т.е. 2 - ноль или единица), N - число "мест" (в нашем случае, число бит)), вспомнить комбинаторику и "правило произведения" (почему число "состояний" перемножается само с собой столько раз, сколько всего "мест"). Первый бит может принимать одно из двух значений (0 или 1), на каждый из способов выбрать первый бит приходится два способа выбрать второй бит. Следовательно, число различных способов выбрать первые два бита числа: 2 способа выбрать первый бит + 2 способа выбрать второй бит, итого 2 * 2 = 4. Добавляем третий бит: четыре способа выбрать первые два бита, когда третий бит принимает значение 0, плюс четыре способа выбрать первые два бита, когда третий бит принимает значение 1, итого 4 + 4 = 8.

Т.е. получилось $2^3 = 8$ новых подсетей путем расширения сетевой части адреса на 3 бита.

#### 3. Количество бит узлов в подсети

Сетевая часть адреса занимает 27 бит, всего IPv4 адрес занимает 32 бита, соответственно, на хостовую (узловую) часть адреса остается 32 - 27 = 5 бит.

#### 4. Количество узлов в подсети

В каждой из получившихся подсетей в адресе остается 5 бит для описания различных хостов - но не все из этих различных $2^5$ значений хостовой части адреса будут использованы как адреса хостов. Тот адрес, в котором все биты в хостовой части - нули, будет использоваться как идентификатор сети, адрес, в котором все биты в хостовой части - единицы, будет использоваться для широковещательной рассылки.

Таким образом, два адреса нужно исключить, получится $2^5 - 2 = 32 - 2 = 30$

Итого, количество узлов в подсети: 30.


#### 5. Сетевой адрес этой подсети

Под "этой" подсетью понимается подсеть, в которую входит исходный узел, адрес которого указан в "Дано", т.е. 192.168.200.139.

Наложим (побитовое логическое "И") маску 255.255.255.224

$11111111.11111111.11111111.11100000_2$

на адрес хоста 192.168.200.139

$11000000.10101000.11001000.10001011_2$

Получаем

$11000000.10101000.11001000.10000000_2$

В десятичном представлении 192.168.200.128/27

#### 6. IPv4-адрес первого узла в этой подсети

Получившийся на предыдущем шаге адрес 192.168.200.128/27 - будем использовать как идентификатор самой сети.

Первый хост в ней будет иметь следующий адрес: 192.168.200.129/27 (добавили один бит в последний октет).

#### 7. IPv4-адрес последнего узла в этой подсети

Сначала заполним биты хостовой части адреса всеми единицами:

192.168.200.128/27

Первые 27 бит адреса мы не трогаем:

$11000000.10101000.11001000.100|00000_2$

Получили

$11000000.10101000.11001000.10011111_2$, последний октет в десятичной системе счисления:  $1 * 2 ^ 7 + 0 * 2 ^ 6 + 0 * 2 ^ 5 + 1 * 2 ^ 4 + 1 * 2 ^ 3 + 1 * 2 ^ 2 + 1 * 2 ^ 1 + 1 * 2 ^ 0 = 128 + 16 + 8 + 4 + 2 + 1 = 159_{10}$

Собираем:

192.168.200.159/27

Последний адрес подсети будем использовать для широковещательной рассылки, поэтому адрес последнего хоста в подсети будет таким 192.168.200.158/27 (на один бит меньше).

Хотя этот адрес можно было найти и иначе, ведь мы уже вычислили число хостов в подсети (30) и знаем первый в этой подсети адрес хоста.

#### 8. Широковещательный IPv4-адрес в этой подсети

Получили на предыдущем шаге, когда искали адрес последнего хоста в подсети:

192.168.200.159/27

Заполним таблицу целиком:

|                                      Ответ: |                      |
| :------------------------------------------ | :------------------- |
| Количество бит подсети                      | $27$                 |
| Количество созданных подсетей               | $8$                  |
| Количество бит узлов в подсети              | $5$                  |
| Количество узлов в подсети                  | $30$                 |
| Сетевой адрес этой подсети                  | $192.168.200.128/27$ |
| IPv4-адрес первого узла в этой подсети      | $192.168.200.129/27$ |
| IPv4-адрес последнего узла в этой подсети   | $192.168.200.158/27$ |
| Широковещательный IPv4-адрес в этой подсети | $192.168.200.159/27$ |

## Задача 2: 

|                     Дано: |                   |
| :------------------------ | :---------------- |
| IP-адрес узла             | $10.101.99.228$   |
| Исходная маска подсети    | $255.0.0.0$       |
| Новая маска подсети       | $255.255.128.0$   |

|                                      Ответ: |                         |
| :------------------------------------------ | :---------------------- |
| Количество бит подсети                      | $17$                    |
| Количество созданных подсетей               | $2 ^ {(17 — 8)} =  512$ |
| Количество бит узлов в подсети              | $32 - 17 = 15$          |
| Количество узлов в подсети                  | $2 ^ {15} — 2 = 32766$  |
| Сетевой адрес этой подсети                  | $10.101.0.0/17$         |
| IPv4-адрес первого узла в этой подсети      | $10.101.0.1/17$         |
| IPv4-адрес последнего узла в этой подсети   | $10.101.127.254/17$     |
| Широковещательный IPv4-адрес в этой подсети | $10.101.127.255/17$     |

## Задача 3: 

|                     Дано: |                   |
| :------------------------ | :---------------- |
| IP-адрес узла             | $172.22.32.12$    |
| Исходная маска подсети    | $255.255.0.0$     |
| Новая маска подсети       | $255.255.224.0$   |

|                                      Ответ: |                         |
| :------------------------------------------ | :---------------------- |
| Количество бит подсети                      | $19$                    |
| Количество созданных подсетей               | $2 ^ {(19 — 16)} = 8$   |
| Количество бит узлов в подсети              | $32 — 19 = 13$          |
| Количество узлов в подсети                  | $2 ^ {13} — 2 = 8190 $  |
| Сетевой адрес этой подсети                  | $172.22.32.0/19$        |
| IPv4-адрес первого узла в этой подсети      | $172.22.32.1/19$        |
| IPv4-адрес последнего узла в этой подсети   | $172.22.63.254/19$      |
| Широковещательный IPv4-адрес в этой подсети | $172.22.63.255/19$      |

## Задача 4: 

|                     Дано: |                   |
| :------------------------ | :---------------- |
| IP-адрес узла             | $192.168.1.245$   |
| Исходная маска подсети    | $255.255.255.0$   |
| Новая маска подсети       | $255.255.255.252$ |

|                                      Ответ: |                         |
| :------------------------------------------ | :---------------------- |
| Количество бит подсети                      | $30$                    |
| Количество созданных подсетей               | $2 ^ {(30 — 24)} = 64$  |
| Количество бит узлов в подсети              | $32 — 30 = 2$           |
| Количество узлов в подсети                  | $2 ^ {2} — 2 = 2 $      |
| Сетевой адрес этой подсети                  | $192.168.1.244/30$      |
| IPv4-адрес первого узла в этой подсети      | $192.168.1.245/30$      |
| IPv4-адрес последнего узла в этой подсети   | $192.168.1.246/30$      |
| Широковещательный IPv4-адрес в этой подсети | $192.168.1.247/30$      |

## Задача 5: 

|                     Дано: |                   |
| :------------------------ | :---------------- |
| IP-адрес узла             | $128.107.0.55$    |
| Исходная маска подсети    | $255.255.0.0$     |
| Новая маска подсети       | $255.255.255.0$   |

|                                      Ответ: |                         |
| :------------------------------------------ | :---------------------- |
| Количество бит подсети                      | $24$                    |
| Количество созданных подсетей               | $2 ^ {(24 — 16)} = 256$ |
| Количество бит узлов в подсети              | $32 — 24 = 8$           |
| Количество узлов в подсети                  | $2 ^ {8} — 2 = 254 $    |
| Сетевой адрес этой подсети                  | $128.107.0.0/24$        |
| IPv4-адрес первого узла в этой подсети      | $128.107.0.1/24$        |
| IPv4-адрес последнего узла в этой подсети   | $128.107.0.254/24$      |
| Широковещательный IPv4-адрес в этой подсети | $128.107.0.255/24$      |

## Задача 6: 

|                     Дано: |                   |
| :------------------------ | :---------------- |
| IP-адрес узла             | $192.135.250.180$ |
| Исходная маска подсети    | $255.255.255.0$   |
| Новая маска подсети       | $255.255.255.248$ |

|                                      Ответ: |                         |
| :------------------------------------------ | :---------------------- |
| Количество бит подсети                      | $29$                    |
| Количество созданных подсетей               | $2 ^ {(29 — 16)} = 13$  |
| Количество бит узлов в подсети              | $32 — 29 = 3$           |
| Количество узлов в подсети                  | $2 ^ {3} — 2 = 6 $      |
| Сетевой адрес этой подсети                  | $192.135.250.176/29$    |
| IPv4-адрес первого узла в этой подсети      | $192.135.250.177/29$    |
| IPv4-адрес последнего узла в этой подсети   | $128.107.0.182/29$      |
| Широковещательный IPv4-адрес в этой подсети | $128.107.0.183/29$      |